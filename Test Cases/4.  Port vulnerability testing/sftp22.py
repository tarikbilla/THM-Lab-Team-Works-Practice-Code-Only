import paramiko
import json
import time

import urllib3
urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)

# Target device
host = "127.0.0.1" 
port = 22

# Load credentials from JSON
with open("credentials.json", "r") as file:
    credentials = json.load(file)

# SSH client setup
ssh = paramiko.SSHClient()
ssh.set_missing_host_key_policy(paramiko.AutoAddPolicy())

# Try each username/password
for entry in credentials:
    username = entry["username"]
    password = entry["password"]
    try:
        print(f"Trying with username:{username} password:{password}")
        ssh.connect(host, port, username=username, password=password, timeout=2)
        print(f"Port 22 SSH is vulnerable! username:{username} password:{password}")
        ssh.close()
        break 
    except paramiko.AuthenticationException:
        print("Failed to login\n")
    except Exception as e:
        print(f"[!] Error: {e}")
    time.sleep(0.5)

else:
    print("Port 22 SSH is not vulnerable.")
